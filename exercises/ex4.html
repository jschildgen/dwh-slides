<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Data Warehousing - Exercise Sheet %%%EX_NO%%%</title>
    <link rel="stylesheet" href="../exercises/exercises.css">
    <link href="../lib/fontawesome.all.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <div>
        <div>
            <b>%%%LECTURE%%% - %%%SEMESTER%%%</b><br>
            %%%LECTURER%%%<br>
            %%%LECTURER_EMAIL%%%<br>
            <b>Exercise Sheet %%%EX_NO%%% (%%%EX_DATES%%%)</b>
        </div>
        <div><img src="../img/oth.png" style="border:0; height:50px"></div>
    </div>
    <hr>
    </header>

    <div style="padding-top: 2.5cm;">
    <div style="background-color: gainsboro;">
        <p><b>You will need some of your answers and queries from this exercise sheet for the next submission (Challenge 3). It is recommended to work on the OTH Exasol database.</b></p>
    </div>
    </div>

<section>
    <h1>Exercise 1: Schema Integration</h1>
    
    <p>In the previous exercise sheet, you created a star and a snowflake schema for your data-warehouse project. Now, decide how your final schema will look and perform a schema integration.</p>
    <ol>
        <li>Inspect the schema of the data that you want to import. For example: If you want to import data from CSV files, open the files in a text editor (not in Excel!) to see its attributes, value formats (date/number formats, ...), and file properties (column separator, ...). A good text editor (Notepad++, Kate, ...) also shows you which encoding is used (e.g., UTF-8) and which line ending (LF (Unix), CRLF (Windows), CR(Mac)). Write down those details, you need them later in your IMPORT command.</li>
        <li>Do the same for at least one more data source.</li>
        <li>Prepare your staging area in Exasol: For each data source (e.g., for each file), create a table in the Exasol database with the same attributes as in your input data. Of course, you can skip the attributes that you never need. Use the table-name prefix <code>st_</code> or <code>staging_</code> to indicate that these tables belong to your staging area.</li>
        <li>Which forms of heterogeneity exist between two of your data sources (technical, data model, semantical, syntactical, schematic, and/or structural)? Only list a few and give examples.</li>
        <li>Perform a schema matching between the two schemas (e.g., on a piece of paper). Which attributes from the one data source correspond with which attributes from the other data source?</li>
        <li>As a last step, you should create an integrated schema in your Exasol database. This is a schema (multiple tables) that can store data from all your data sources. You can use your solution from the previous exercise sheet (your star or snowflake schema) for this, and - if necessary - extend or adjust it. As a result, you will have the final version of your integrated schema. Write down the <code>CREATE TABLE</code> commands to create the schema. Do not yet fill the tables with data.</li>
    </ol>
    
</section>

<section>
    <h1>Exercise 2: IMPORT</h1>
    <ol>
        <li>Write down Exasol <code>IMPORT</code> commands to import data from your data sources into your staging area. If your data is not in CSV format, it can be a good idea to write a little Python program that outputs CSV files (e.g. a converter from JSON to CSV, or a tool that accesses an API and stores the data in a CSV file). At the end of your <code>IMPORT</code> command, write: <code>ERRORS INTO error_tbl REJECT LIMIT UNLIMITED;</code> (drop the table error_tbl if it is already there). Exasol will write errors that happen during the import process into that table.</li>
        <li>Inspect your target tables and the error table (both with <code>LIMIT 50</code> or so). When there are errors, try to fix them, truncate the target table again and re-import the data.</li>
        <li>When you are fine with your result, count for each of your tables in the staging area, how many rows are in these tables?</li>
    </ol>

</section>

<script src="./js/exercises.js"></script>
    
</body>
</html>