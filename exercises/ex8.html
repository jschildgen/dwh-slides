<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Data Warehousing - Exercise Sheet 8</title>
    <link rel="stylesheet" href="../exercises/exercises.css">
    <link href="../lib/fontawesome.all.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <div>
        <div>
            <b>Data Warehousing - SS 2022</b><br>
            Prof. Dr.-Ing. Johannes Schildgen<br>
            johannes.schildgen@oth-regensburg.de<br>
            <b>Exercise Sheet 8 (2022-05-18/21/23)</b>
        </div>
        <div><img src="../img/oth.png" style="border:0; height:50px"></div>
    </div>
    <hr>
    </header>
<section style="padding-top: 2.5cm">
    <h1>Exercise 1: Data Integration</h1>
    <p>This exercise is the continuation of the previous exercise sheet. Make sure that you have a staging area with two cities tables (from data two different sources) and an empty target cities table.</p>
    
    <ol>
        <li>Add a column <code>error_info</code> of type <code>VARCHAR(2000)</code> to both source tables.</li>
        <li>For each of the two individual source tables (not cross-table!), find out whether there are rows with the same zip code and same city name. For the matching rows, set the error code to an appropriate error message.</li>
        <li>For each city of the first table, find a matching city of the second source table using (a) equal join, (b) similarity join with an Levenshtein less than an appropriate threshold, (c) similarity join using Soundex. For each approach, write down the number of cities that find a match.</li>
        <li>Which cities find a match with Levenshtein that do not find a match with Soundex and vice versa? Are there false positives (match found but it shouldn't be a match)? Are there false negatives (it should be a match but no match found)?</li>
        <li>Choose an appropriate matching method (equal join, Levenshtein, or Soundex) to integrate the data from the source tables into the target table.</li>
        <li>Also integrate the rows that only appear in one of the source tables in the target table.</li>
        <li>In the target table, find out the 20 most common first words that city names have which consist of multiple words. It should show values like Bad, Alt, Neu, ... (Hint: If you have no idea how to extract the first word of a string, you find a similar expression on exercise sheet 3).</li>
    </ol>
</section>


    
</body>
</html>