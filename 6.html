<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>DWH - Chapter 6 - Visualizations</title>

		<link rel="stylesheet" href="reveal.js/dist/reset.css">
		<link rel="stylesheet" href="reveal.js/dist/reveal.css">

        <link rel="stylesheet" href="src/slides.css">
        <link rel="stylesheet" href="src/sql.css">

		<link rel="stylesheet" href="src/layout.css">
        <link rel="stylesheet" href="lib/joint.min.css" />
        <link rel="stylesheet" href="src/erd.css" />
        <link rel="stylesheet" href="src/poll.css" />

		<!-- Theme used for syntax highlighting of code -->
		<script>
			if(window.location.search.match( /print-pdf/gi )) {
				document.getElementsByTagName( "head" )[0].innerHTML += '<link rel="stylesheet" href="src/routeros.css">';
			} else {
				document.getElementsByTagName( "head" )[0].innerHTML += '<link rel="stylesheet" href="src/rainbow.css">';
			}
			</script>

        <!--<script defer src="lib/fontawesome.all.min.js"/>-->
        <link href="lib/fontawesome.all.min.css" rel="stylesheet">
        <style> .reveal i.fa { font-family:FontAwesome; font-style: normal; } </style>
	</head>
	<body>
		<div class="reveal">
            <div id="header"></div>
            <div id="footer"></div>
			<div class="slides">
                <section>
                    <h4 style="text-align:center"><b>Prof. Dr.-Ing. Johannes Schildgen</b><br>
                    <a href="mailto:johannes.schildgen@oth-regensburg.de">johannes.schildgen@oth-regensburg.de</a></h4>
                    <h2>Data Warehousing</h2>
                    <h4 style="text-align:center">&nbsp;</h4>
                    <h3 style="font-size: 140%">Chapter 6: Business Intelligence (BI)</h3>
										<h3>&nbsp;</h3>
                    <h4 style="text-align:center">&nbsp;<br>&nbsp;</h4>
                    <img src="img/ccby.png" height="60px" style="position: absolute; left:0px; border:0; bottom:-80px;">
                    <img src="img/oth.png" height="60px" style="position: absolute; right:0px; border:0; bottom:-80px; box-shadow:none">
                </section>
                
								<section>
									<h3>Business Intelligence (BI)</h3>
									<div style="position: absolute; top: 140px; right:-20px;"><img src="img/6/powerbi.png" style="width: 12cm;" class="noborder"></div>
									<p class="small">Strategies and technologies to access and analyze business information.</p>
									<ul class="small" style="margin-top: -4mm;">
										<li>reporting</li>
										<li>dashboard development</li>
										<li>data mining</li>
										<li>predictive analytics</li>
										<li>...</li>
									</ul>
									<p class="small" style="margin-top: 2mm;">&Rightarrow; support business decision-making</p>
									<div class="fragment">
										<h4>BI Tools:</h4>
										<ul class="small" style="margin-top: -4mm;">
											<li>Tableau</li>
											<li>Microsoft Power BI</li>
											<li>Qlik</li>
											<li>MicroStrategy</li>
											<li>Pyramid</li>
											<li>Bissantz</li>
											<li>...</li>
										</ul>
									</div>
									<aside class="notes">The goal of BI is getting insights into data to support business decisions. </aside>
								</section>

								<section>
									<h2>Microsoft Power BI</h2>
									<p class="small" style="margin-left: -4mm;">BI tool for real-time data insights for both technical and non-technical users.</p>
									<h4 style="margin-left: -4mm;">Features</h4>
									<ul class="small" style="margin-left: -4mm;">
										<li><em>Data Connectivity</em>: Connect to various data sources (databases, files, ...)</li>
										<li><em>Data Transformation</em>: Data cleaning, shaping, and transformation</li>
										<li><em>Data Modelling</em>: Complex data models, relationships between different data sources</li>
										<li><em>Interactive Reports</em>: Various visualization types (charts, graphs, maps, ...)</li>
										<li><em>Dashboards</em>: Combine multiple reports to a single dashboard; real-time updates</li>
										<li><em>Collaboration</em>: Share dashboards and reports, embed reports in other applications</li>
										<li><em>AI</em>: Integrate with AI tools, natural language queries, advanced analytics</li>
									</ul>

									<h4 style="margin-top:1cm; margin-left: -4mm;">Editions</h4>
									<ul class="small" style="margin-left: -4mm;">
											<li>Power BI Desktop, Power BI Service (cloud), Power BI Mobile</li>
											<li>Free Version, Pro (paid per user), Premium (large-scale deployments)</li>
									</ul>
								</section>

								<section>
									<h3>Installation and Connection</h3>
									<h4>Power BI Desktop for Windows</h4>
									<ul class="small">
										<li><em>Microsoft Store</em>: Search for Power BI Desktop</li>
										<li><em>Chocolatey (Package Manager)</em>: <code>choco install powerbi</code></li>
										<li>Login with Microsoft account optional</li>
									</ul>

									<p class="small"></p>

									<h4>Connecting to a Data Source</h4>
									<p class="small">File &rightarrow; New &rightarrow; Report</p>
									<ul class="small">
										<li>Import Data (from file, cloud service, database, ...), store it in the report</li>
										<li>Direct Query: Queries are directly sent to the data source in real time when interacting with a report.</li>
									</ul>
									<img src="img/6/powerbi_import.png" alt="Power BI Import Data" class="noborder" style="width:18cm">
								</section>
							
								<section>
									<h3>Connect Power BI to Exasol</h3>
									<ul class="small">
										<li>Get data from another source &rightarrow; Databases &rightarrow; Exasol</li>
										<li>Enter the connection string (IP address with fingerprint (copy from DBeaver))</li>
										<li>Choose Encrypted: Yes; and Direct Query</li>
										<li>Enter database username, and password</li>
										<li>Choose tables from schema</li>
									</ul>

									<div class="columns">
										<div><img src="img/6/powerbi_connect_exasol.png" alt="Connect to Exasol" style="width:15cm" class="noborder"></div>
										<div><img src="img/6/powerbi_select_tables.png" alt="Select tables" class="noborder"></div>
									</div>

									<aside class="notes">Direcy Query is a powerful feature. Power BI knows which parts of a query can be executed by the source system (e.g. filters, aggregations), and which operations Power BI needs to compensate.</aside>
								</section>		

								<section>
									<h3>Model View</h3>
									<ul class="small">
										<li>Check columns and their data types</li>
										<li>Create relationships: <br>Drag foreign-key column to primary-key column</li>
										<li>Cross-Filter Direction for relationships:<br>Allow filters from single table only or from both sides</li>
										<li>Columns can be renamed, hidden, changed, ...</li>
									</ul>
									<img src="img/6/powerbi_model.png" alt="Model" class="noborder">
									
									<div style="position: absolute; top:0mm; right:0mm; width: 7cm">
										<img src="img/6/powerbi_model_view.png" alt="Model View" class="noborder">
									</div>
								</section>

								<section>
									<h3>Dimension Hierarchies</h3>

									<h4>Hierarchies</h4>
									<ul class="small">
										<li>If hierarchy attributes are across multiple tables, add new column to table:</li>
									</ul>
									<pre style="margin-top: 2mm;"><code class="plaintext">COUNTRY_CODE = RELATED(CITIES[COUNTRY_CODE])</code></pre>
									<ul class="small" style="margin-top: -2mm;">
										<li>Right click on table &rightarrow; New hierarchy</li>
										<li>Add columns to the hierarchy (from coarse to fine)</li>
									</ul>

									<p class="small"></p>

									<h4 style="margin-top: -2mm;">Date Hierarchy</h4>
									<ul class="small" style="margin-top: -2mm;">
										<li>Right click on table &rightarrow; Mark as date table</li>
										<li>The time-intelligence feature adds a date dimension to date tables.</li>
										<li>Alternative: Add DAY, MONTH, YEAR columns to table and create hierarchy:</li>
									</ul>
									<pre><code class="plaintext" style="margin-top: -2mm;">YEAR = Year(SALES[SALES_DATE])</code></pre>
									<ul class="small" style="margin-top: -3mm;">
										<li>Alternative 2: Create date-dimension table (see next slide) and relationship</li>
									</ul>

									<div style="position: absolute; top:0cm; right:0mm;">
										<img src="img/6/powerbi_day_hierarchy.png" alt="Model View" class="noborder">
									</div>
										<div style="position: absolute; top:5cm; right:0mm; width: 7cm">
											<img src="img/6/powerbi_model_hierarchy.png" alt="Model View" class="noborder">
										</div>

										<aside class="notes">When adding a new column, you have to provide a so-called DAX query that defines how the values for this column are calculated.</aside>
								</section>

								<section>
									<h3>Date-Dimension Table</h3>
									<pre><code class="sql">CREATE OR REPLACE TABLE DIM_DATE (
  "DATE" DATE PRIMARY KEY, "YEAR" INT, "QUARTER" VARCHAR(2), 
  "MONTH_NAME" VARCHAR(20), "MONTH" INT, 
  "DAY" INT, "WEEKDAY" VARCHAR(20)
);</code></pre>

								<pre style="max-height: 99cm;"><code style="max-height: 99cm;" class="sql">INSERT INTO DIM_DATE ("DATE", "YEAR", "QUARTER", "MONTH_NAME", 
                      "MONTH", "DAY", "WEEKDAY")
SELECT DISTINCT
  sales_date AS "DATE",
  year(sales_date) AS "YEAR",
  CASE
      WHEN MONTH(sales_date) IN (1, 2, 3) THEN 'Q1'
      WHEN MONTH(sales_date) IN (4, 5, 6) THEN 'Q2'
      WHEN MONTH(sales_date) IN (7, 8, 9) THEN 'Q3'
      WHEN MONTH(sales_date) IN (10, 11, 12) THEN 'Q4'
  END AS "QUARTER",
  TO_CHAR(sales_date, 'Month') AS "MONTH_NAME",
  month(sales_date) AS "MONTH",
  day(sales_date) AS "DAY",
  TO_CHAR(sales_date, 'Day') AS "WEEKDAY"
FROM retail.sales;</code></pre>
								</section>

								<section>
									<h3>Reports</h3>
									<div style="position: absolute; top:0cm; right:0mm;">
										<img src="img/6/powerbi_report_view.png" alt="Model View" class="noborder">
									</div>

									<ul class="small">
										<li>To add a new visual, first make sure nothing is selected</li>
										<li>Choose visual: <img src="img/6/visuals1.png" class="noborder" style="margin-top: -5mm; margin-bottom:-1mm; height:6.9mm"><img src="img/6/visuals2.png" class="noborder" style="margin-top: -5mm; margin-bottom:-1mm; height:6.9mm">... </li>
										<li>Drag columns to fields (e.g., x-axis, y-axis, color, size, ...)</li>
										<li>Format visual: Change colors, labels, axis, ...</li>
										<li>Use filters to limit data</li>
										<li>Use slicers to interactively filter data: <img src="img/6/powerbi_slicer.png" class="noborder" style="margin-top: -5mm; margin-bottom:-1mm; height:8mm"></li>
									</ul>

									<img src="img/6/powerbi_linechart.png" alt="Line Chart" class="noborder stretch" style="margin-left:-2cm">

									<div style="position: absolute; top:5cm; right:0mm;">
										<img src="img/6/powerbi_axis.png" alt="Axes" class="noborder">
									</div>
								</section>

								<section>
									<h3>Hierarchies: Rollup and Drilldown</h3>
									<ul class="small" style="margin-left: 3mm;">
										<li>Use hierarchy as x-axis to enable Hierarchical operations</li>
										<li>&uarr; Rollup: Aggregate data to more coarse-granular levels of the hierarchy</li>
										<li>&darr; Drilldown Mode: When activated, clicking on element shows more detailed data</li>
									</ul>
									<div class="columns">
										<div><img src="img/6/powerbi_bar_h.png" alt="Barchart" class="noborder"></div>
										<div><img src="img/6/powerbi_axis_h.png" alt="Axes" class="noborder"></div>
									</div>
								</section>

								<section>
									<h3>Maps / Geo Data</h3>
									<ul class="small">
										<li>Enable: Options &rightarrow; Global &rightarrow; Security &rightarrow; Use Map and Filled Map visuals</li>
										<li>Create Map (with bubbles or heat map) or Filled Map <img src="img/6/powerbi_visuals_map.png" class="noborder" style="margin-top: -5mm; margin-bottom:-1mm; height:8mm"></li>
										<li>Provide geo data either from text column (city, country, ...) or lat/lon</li>

										<img src="img/6/powerbi_maps.png" alt="Maps" class="noborder">
								</section>
			</div>
		</div>

		

		<script src="reveal.js/dist/reveal.js"></script>
		<script src="reveal.js/plugin/markdown/markdown.js"></script>
		<script src="reveal.js/plugin/highlight/highlight.js"></script>
		<script src="reveal.js/plugin/zoom/zoom.js"></script>
		<script src="reveal.js/plugin/math/math.js"></script>
		<script src="reveal.js/plugin/notes/notes.js"></script>
		<script src="reveal.js/plugin/search/search.js"></script>
		<script src="lib/chart.min.js"></script>
		<script src="plugins/revealjs-chart.js"></script>
		
        <script src="lib/jquery.js"></script>
        <script src="lib/lodash.js"></script>
        <script src="lib/backbone.js"></script>
        <script src="lib/joint.min.js"></script>
				<script src="lib/deflate.js"></script>

		<script src="src/init_reveal.js"></script>

        <script>
        if(window.location.search.match( /print-pdf/gi )) {
                document.getElementById('header').style="display:none";
                document.getElementById('footer').style="display:none";
        }
        </script>


	</body>
</html>
